}
if (!require("arm")) {
install.packages("arm")
library("arm")
}
if (!require("questionr")) {
install.packages("questionr")
library("questionr")
}
if (!require("ggeffects")) {
install.packages("ggeffects")
library("ggeffects")
}
if (!require("MASS")) {
install.packages("MASS")
library("MASS")
}
if (!require("corrplot")) {
install.packages("corrplot")
library("corrplot")
}
if (!require("mgcv")) {
install.packages("mgcv")
library("mgcv")
}
if (!require("polynom")) {
install.packages("polynom")
library("polynom")
}
if (!require("biostat3")) {
install.packages("biostat3")
library("biostat3")
}
if (!require("tidyr")) {
install.packages("tidyr")
library("tidyr")
}
if (!require("dplyr")) {
install.packages("dplyr")
library("dplyr")
}
if (!require("ggplot2")) {
install.packages("ggplot2")
library("ggplot2")
}
if (!require("cowplot")) {
install.packages("cowplot")
library("cowplot")
}
if (!require("ade4")) {
install.packages("ade4")
library("ade4")
}
if (!require("factoextra")) {
install.packages("factoextra")
library("factoextra")
}
if (!require("sf")) {
install.packages("sf")
library("sf")
}
if (!require("mapview")) {
install.packages("mapview")
library("mapview")
}
if (!require("vegan")) {
install.packages("vegan")
library("vegan")
}
if (!require("ggpubr")) {
install.packages("ggpubr")
library("ggpubr")
}
if (!require("car")) {
install.packages("car")
library("car")
}
if (!require("jtools")) {
install.packages("jtools")
library("jtools")
}
if (!require("visreg")) {
install.packages("visreg")
library("visreg")
}
if (!require("arm")) {
install.packages("arm")
library("arm")
}
if (!require("questionr")) {
install.packages("questionr")
library("questionr")
}
if (!require("ggeffects")) {
install.packages("ggeffects")
library("ggeffects")
}
if (!require("MASS")) {
install.packages("MASS")
library("MASS")
}
if (!require("corrplot")) {
install.packages("corrplot")
library("corrplot")
}
if (!require("mgcv")) {
install.packages("mgcv")
library("mgcv")
}
if (!require("polynom")) {
install.packages("polynom")
library("polynom")
}
if (!require("biostat3")) {
install.packages("biostat3")
library("biostat3")
}
# Use the convert_ipynb() function
convert_ipynb(input = input_file, output = output_file)
output_file <- "/media/haupert/data/mes_projets/07_nroi/nROI_publication.git/notebooks/R_01_correlation_indices.Rmd"
# Install the knitr package if you haven't already
install.packages("knitr")
# Use the knit() function from knitr to convert the .ipynb file
knit(input = input_file, output = output_file)
# Construct the command for jupyter nbconvert
command <- paste0("jupyter nbconvert --to rmarkdown ", shQuote(input_file), " --output ", shQuote(output_file))
# Specify the input and output file paths
input_file <- "/media/haupert/data/mes_projets/07_nroi/nROI_publication.git/notebooks/R_01_correlation_indices.ipynb"
print(exit_status)
# LOAD LIBRARIES
library(data.table)
# LOAD LIBRARIES
library(data.table)
library(corrplot)
# OPTIONS
CORRELATION_TYPE = 'spearman'
# IMPORT CSV (you may need to adapt the path depending on your working directory)
data = fread("../results/data_species.csv")
setwd("/media/haupert/data/mes_projets/07_nroi/nROI_publication.git/haupert_acoustic_indices_2025/notebooks")
# IMPORT CSV (you may need to adapt the path depending on your working directory)
data = fread("../results/data_species.csv")
# Extract the acoustic index only
data_index = data[,c(2:61)]
data_index_selection = data_index [,c('ACTtFraction', 'ACTtCount', 'EVNtFraction', 'EVNtMean', 'EVNtCount',
'MEANf', 'SKEWf', 'KURTf', 'NP', 'SNRf', 'Hf', 'H', 'EAS', 'ECU', 'ECV',
'EPS', 'EPS_KURT', 'EPS_SKEW', 'ACI', 'NDSI', 'rBA', 'BioEnergy', 'BIO',
'ADI', 'AEI', 'LFC', 'MFC', 'ACTspFract', 'ACTspCount', 'ACTspMean', 'EVNspFract',
'EVNspMean', 'EVNspCount', 'TFSD', 'H_Havrda', 'H_Renyi', 'H_pairedShannon',
'H_GiniSimpson', 'AGI', 'nROI', 'aROI')]
# Resize the figure
options(repr.plot.width = 20, repr.plot.height = 15, repr.plot.res = 300)
# I want a color palette with 10 colors (in order to have a step of 0.25) that I choose
# I set |R|>0.75 to dark blue or red colors for easy reading
col = c("#003881d2", "#97deff96", "#97deff96","#97deff96", "#ff826c86", "#ff826c86", "#ff826c86",  "#b82b00e8")
# Compute the correlation matrix
cor_matrix = cor(data_index_selection, method=CORRELATION_TYPE, use="pairwise.complete.obs")
# compute the statistics and p-value
pvalue_matrix = cor.mtest(data_index_selection, conf.level = 0.95)$p
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 50,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
# Resize the figure
options(repr.plot.width = 20, repr.plot.height = 15, repr.plot.res = 300)
# I want a color palette with 10 colors (in order to have a step of 0.25) that I choose
# I set |R|>0.75 to dark blue or red colors for easy reading
col = c("#003881d2", "#97deff96", "#97deff96","#97deff96", "#ff826c86", "#ff826c86", "#ff826c86",  "#b82b00e8")
# Compute the correlation matrix
cor_matrix = cor(data_index_selection, method=CORRELATION_TYPE, use="pairwise.complete.obs")
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 30,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.6,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.6,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
# Resize the figure
options(repr.plot.width = 15, repr.plot.height = 15, repr.plot.res = 300)
# I want a color palette with 10 colors (in order to have a step of 0.25) that I choose
# I set |R|>0.75 to dark blue or red colors for easy reading
col = c("#003881d2", "#97deff96", "#97deff96","#97deff96", "#ff826c86", "#ff826c86", "#ff826c86",  "#b82b00e8")
# Compute the correlation matrix
cor_matrix = cor(data_index_selection, method=CORRELATION_TYPE, use="pairwise.complete.obs")
# compute the statistics and p-value
pvalue_matrix = cor.mtest(data_index_selection, conf.level = 0.95)$p
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
# Resize the figure
options(repr.plot.width = 15, repr.plot.height = 15, repr.plot.res = 300)
# I want a color palette with 10 colors (in order to have a step of 0.25) that I choose
# I set |R|>0.75 to dark blue or red colors for easy reading
col = c("#003881d2", "#97deff96", "#97deff96","#97deff96", "#ff826c86", "#ff826c86", "#ff826c86",  "#b82b00e8")
# Compute the correlation matrix
cor_matrix = cor(data_index_selection, method=CORRELATION_TYPE, use="pairwise.complete.obs")
# compute the statistics and p-value
pvalue_matrix = cor.mtest(data_index_selection, conf.level = 0.95)$p
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
library(corrplot)
# OPTIONS
CORRELATION_TYPE = 'spearman'
# IMPORT CSV (you may need to adapt the path depending on your working directory)
data = fread("../results/data_species.csv")
# Extract the acoustic index only
data_index = data[,c(2:61)]
# select the columns by their name
# data_index_selection = data_index [,c('ZCR', 'EVNtMean', 'MEANf', 'SKEWf', 'KURTf', 'NP', 'SNRf', 'Hf', 'H', 'EAS', 'ECU',
#                                 'ECV', 'EPS', 'ACI', 'NDSI', 'rBA', 'BioEnergy', 'BIO', 'LFC', 'MFC', 'ACTspFract',
#                                 'ACTspCount', 'ACTspMean', 'EVNspFract', 'EVNspMean', 'EVNspCount', 'TFSD',
#                                 'H_Havrda', 'H_Renyi', 'H_pairedShannon', 'H_GiniSimpson', 'AGI', 'nROI', 'aROI')]
data_index_selection = data_index [,c('ACTtFraction', 'ACTtCount', 'EVNtFraction', 'EVNtMean', 'EVNtCount',
'MEANf', 'SKEWf', 'KURTf', 'NP', 'SNRf', 'Hf', 'H', 'EAS', 'ECU', 'ECV',
'EPS', 'EPS_KURT', 'EPS_SKEW', 'ACI', 'NDSI', 'rBA', 'BioEnergy', 'BIO',
'ADI', 'AEI', 'LFC', 'MFC', 'ACTspFract', 'ACTspCount', 'ACTspMean', 'EVNspFract',
'EVNspMean', 'EVNspCount', 'TFSD', 'H_Havrda', 'H_Renyi', 'H_pairedShannon',
'H_GiniSimpson', 'AGI', 'nROI', 'aROI')]
# Resize the figure
options(repr.plot.width = 20, repr.plot.height = 15, repr.plot.res = 300)
# I want a color palette with 10 colors (in order to have a step of 0.25) that I choose
# I set |R|>0.75 to dark blue or red colors for easy reading
col = c("#003881d2", "#97deff96", "#97deff96","#97deff96", "#ff826c86", "#ff826c86", "#ff826c86",  "#b82b00e8")
# Compute the correlation matrix
cor_matrix = cor(data_index_selection, method=CORRELATION_TYPE, use="pairwise.complete.obs")
# compute the statistics and p-value
pvalue_matrix = cor.mtest(data_index_selection, conf.level = 0.95)$p
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 1,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.8,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.8,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.75,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.75,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.66,
cl.ratio =0.1,
cl.cex = 1
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.66,
cl.ratio =0.1,
cl.cex = 0.66
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.5,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.66,
cl.ratio =0.1,
cl.cex = 0.66
)
# plot the correlation matrix with the p-value
corrplot_obj = corrplot(
# corr=cor_matrix[manual_order,manual_order],
corr=cor_matrix,
p.mat = pvalue_matrix,
order = 'hclust',
method = 'circle',
insig = 'label_sig',
sig.level = c(0.001, 0.01, 0.05),
col = col,
pch.cex = 0.7,
pch.col = '#1a1a1a8c',
tl.col = '#000000',
tl.srt = 45,
tl.cex = 0.66,
cl.ratio =0.1,
cl.cex = 0.66
)
